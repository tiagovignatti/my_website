<article class="homepage-content">
  <!-- Hero Section -->
  <header class="hero">
    <h1 class="hero-title">
      <strong>Tiago</strong> enjoys mixing code with creative work.
    </h1>
    <p class="hero-subtitle">
      Exploring software, media, and social systems as paths to empower nature.
    </p>
    <p class="hero-subtitle">
      Currently helping build the Web at <a href="https://www.igalia.com" target="_blank">Igalia</a>.
    </p>
  </header>

  <!-- Recent Texts Section -->
  {{ $allPosts := where site.RegularPages "Section" "posts" }}
  {{ $recentOne := first 1 $allPosts }}
  {{ $picked1 := site.GetPage "/posts/my-startup-dream" }}
  {{ $picked2 := site.GetPage "/posts/from-madrid-bus" }}
  {{ $cardPages := $recentOne | append $picked1 | append $picked2 }}

  {{/* Collect card permalinks to exclude from sidebar */}}
  {{ $cardLinks := slice }}
  {{ range $cardPages }}
    {{ $cardLinks = $cardLinks | append .RelPermalink }}
  {{ end }}

  <section class="recent-texts">
    <div class="texts-layout">
      <div class="texts-grid">
        {{ range $cardPages }}
          <a href="{{ .RelPermalink }}" class="text-card">
            {{ $featuredURL := "" }}
            {{ with .Params.featuredImagePreview }}
              {{ $featuredURL = . | relURL }}
            {{ end }}
            {{ with .Params.featureimage }}
              {{ $featuredURL = . | relURL }}
            {{ end }}
            {{ if $featuredURL }}
              <div class="text-card-image">
                <img src="{{ $featuredURL }}" alt="{{ .Title }}" class="nozoom" loading="lazy">
              </div>
            {{ end }}
            <div class="text-card-content">
              <h3 class="text-card-title">{{ .Title }}</h3>
              {{ with .Params.summary }}<p class="text-card-summary">{{ . }}</p>{{ end }}
              <time class="text-card-date">{{ .Date.Format "January 2006" }}</time>
            </div>
          </a>
        {{ end }}

        <!-- Video card -->
        <div class="text-card">
          <div class="text-card-image text-card-video">
            <iframe
              src="https://www.youtube.com/embed/igkTbuLzJwQ"
              title="YouTube video"
              frameborder="0"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen
              loading="lazy">
            </iframe>
          </div>
          <div class="text-card-content">
            <h3 class="text-card-title">O canto sincronizado dos aracuãs</h3>
            <p class="text-card-summary">Os aracuãs têm entre 42 e 53 centímetros de comprimento. O seu aspecto geral é semelhante a um faisão...</p>
          </div>
        </div>
      </div>

      <aside class="texts-sidebar">
        <h4 class="texts-sidebar-title">Texts</h4>
        <p class="texts-sidebar-desc">Loose, unopinionated writings on things I don't entirely understand yet.</p>
        <ul class="texts-sidebar-list">
          {{ $count := 0 }}
          {{ range $allPosts }}
            {{ if and (lt $count 10) (not (in $cardLinks .RelPermalink)) }}
              <li><a href="{{ .RelPermalink }}">{{ .Title }}</a></li>
              {{ $count = add $count 1 }}
            {{ end }}
          {{ end }}
        </ul>
        <a href="/posts/" class="texts-sidebar-all">See all texts →</a>
      </aside>
    </div>

    <div class="see-all see-all-mobile">
      <a href="/posts/">See all texts →</a>
    </div>
  </section>

  <!-- Library Section -->
  <section class="library">
    <h2 class="library-title">Library</h2>
    <p class="library-subtitle">Books I've read or that I'm currently reading.</p>
    <div class="library-grid">
      {{ range first 4 site.Data.library }}
        <a href="{{ .goodreadsUrl }}" target="_blank" class="book-card">
          <div class="book-cover">
            {{ if .cover }}
              <img src="{{ .cover }}" alt="{{ .title }}" class="nozoom" loading="lazy">
            {{ else }}
              <div class="book-cover-placeholder"><span>{{ .title }}</span></div>
            {{ end }}
            <span class="book-overlay">View on Goodreads <svg width="16" height="16" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.25 5.5a.75.75 0 0 0-.75.75v8.5c0 .414.336.75.75.75h8.5a.75.75 0 0 0 .75-.75v-4a.75.75 0 0 1 1.5 0v4A2.25 2.25 0 0 1 12.75 17h-8.5A2.25 2.25 0 0 1 2 14.75v-8.5A2.25 2.25 0 0 1 4.25 4h5a.75.75 0 0 1 0 1.5h-5Zm7.97-2.03a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 .53.22.75.75 0 0 1 .22.53v5a.75.75 0 0 1-1.5 0V5.56l-6.22 6.22a.75.75 0 1 1-1.06-1.06l6.22-6.22H12.97a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"/></svg></span>
          </div>
          <div class="book-info">
            <span class="book-title">{{ .title }}</span>
            <span class="book-author">{{ .author }}</span>
          </div>
        </a>
      {{ end }}
    </div>
    <div class="see-all">
      <a href="/library/">See all books →</a>
    </div>
  </section>
</article>
